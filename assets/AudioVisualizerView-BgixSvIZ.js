import{M as p,O as pe,B as y,e as Z,f as B,U as Y,V as x,W as U,H as E,N as ge,g as ve,a as k,h as C,A as _,i as z,S as he,j as Q,k as V,l as xe,m as X,I as ce,n as W,o as we,T as q,b as v,c as T,d as S,L as N,p as K,q as ye,r as j,s as be,R as J,D as H,t as Me,u as $,F as ee,v as Ce,w as te,x as se,G as Te,P as Se,y as Ae,z as Pe}from"./ThreeManager-CZXi-PRp.js";import{_ as ue,I as _e,c as w,a as m,b,d as O,n as ie,F as oe,e as ae,f as re,g as ne,t as A,h as ze,r as de,o as g,w as Be,T as ke,i as Fe,v as Ge}from"./index-BBKOWY9t.js";const R={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class G{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const De=new pe(-1,1,1,-1,0,1);class Ue extends y{constructor(){super(),this.setAttribute("position",new Z([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Z([0,2,0,0,2,0],2))}}const Ee=new Ue;class me{constructor(e){this._mesh=new p(Ee,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,De)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class fe extends G{constructor(e,t="tDiffuse"){super(),this.textureID=t,this.uniforms=null,this.material=null,e instanceof B?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Y.clone(e.uniforms),this.material=new B({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this._fsQuad=new me(this.material)}render(e,t,a){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=a.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}}class le extends G{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,a){const o=e.getContext(),i=e.state;i.buffers.color.setMask(!1),i.buffers.depth.setMask(!1),i.buffers.color.setLocked(!0),i.buffers.depth.setLocked(!0);let r,n;this.inverse?(r=0,n=1):(r=1,n=0),i.buffers.stencil.setTest(!0),i.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),i.buffers.stencil.setFunc(o.ALWAYS,r,4294967295),i.buffers.stencil.setClear(n),i.buffers.stencil.setLocked(!0),e.setRenderTarget(a),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),i.buffers.color.setLocked(!1),i.buffers.depth.setLocked(!1),i.buffers.color.setMask(!0),i.buffers.depth.setMask(!0),i.buffers.stencil.setLocked(!1),i.buffers.stencil.setFunc(o.EQUAL,1,4294967295),i.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),i.buffers.stencil.setLocked(!0)}}class Re extends G{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Ve{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const a=e.getSize(new x);this._width=a.width,this._height=a.height,t=new U(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:E}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new fe(R),this.copyPass.material.blending=ge,this.clock=new ve}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let a=!1;for(let o=0,i=this.passes.length;o<i;o++){const r=this.passes[o];if(r.enabled!==!1){if(r.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(o),r.render(this.renderer,this.writeBuffer,this.readBuffer,e,a),r.needsSwap){if(a){const n=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(n.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(n.EQUAL,1,4294967295)}this.swapBuffers()}le!==void 0&&(r instanceof le?a=!0:r instanceof Re&&(a=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new x);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const a=this._width*this._pixelRatio,o=this._height*this._pixelRatio;this.renderTarget1.setSize(a,o),this.renderTarget2.setSize(a,o);for(let i=0;i<this.passes.length;i++)this.passes[i].setSize(a,o)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Le extends G{constructor(e,t,a=null,o=null,i=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=a,this.clearColor=o,this.clearAlpha=i,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this.isRenderPass=!0,this._oldClearColor=new k}render(e,t,a){const o=e.autoClear;e.autoClear=!1;let i,r;this.overrideMaterial!==null&&(r=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(i=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:a),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(i),this.overrideMaterial!==null&&(this.scene.overrideMaterial=r),e.autoClear=o}}const Ie={uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new k(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			float v = luminance( texel.xyz );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class F extends G{constructor(e,t=1,a,o){super(),this.strength=t,this.radius=a,this.threshold=o,this.resolution=e!==void 0?new x(e.x,e.y):new x(256,256),this.clearColor=new k(0,0,0),this.needsSwap=!1,this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let i=Math.round(this.resolution.x/2),r=Math.round(this.resolution.y/2);this.renderTargetBright=new U(i,r,{type:E}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let h=0;h<this.nMips;h++){const u=new U(i,r,{type:E});u.texture.name="UnrealBloomPass.h"+h,u.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(u);const d=new U(i,r,{type:E});d.texture.name="UnrealBloomPass.v"+h,d.texture.generateMipmaps=!1,this.renderTargetsVertical.push(d),i=Math.round(i/2),r=Math.round(r/2)}const n=Ie;this.highPassUniforms=Y.clone(n.uniforms),this.highPassUniforms.luminosityThreshold.value=o,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new B({uniforms:this.highPassUniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}),this.separableBlurMaterials=[];const l=[6,10,14,18,22];i=Math.round(this.resolution.x/2),r=Math.round(this.resolution.y/2);for(let h=0;h<this.nMips;h++)this.separableBlurMaterials.push(this._getSeparableBlurMaterial(l[h])),this.separableBlurMaterials[h].uniforms.invSize.value=new x(1/i,1/r),i=Math.round(i/2),r=Math.round(r/2);this.compositeMaterial=this._getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1;const c=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=c,this.bloomTintColors=[new C(1,1,1),new C(1,1,1),new C(1,1,1),new C(1,1,1),new C(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,this.copyUniforms=Y.clone(R.uniforms),this.blendMaterial=new B({uniforms:this.copyUniforms,vertexShader:R.vertexShader,fragmentShader:R.fragmentShader,premultipliedAlpha:!0,blending:_,depthTest:!1,depthWrite:!1,transparent:!0}),this._oldClearColor=new k,this._oldClearAlpha=1,this._basic=new z,this._fsQuad=new me(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this._basic.dispose(),this._fsQuad.dispose()}setSize(e,t){let a=Math.round(e/2),o=Math.round(t/2);this.renderTargetBright.setSize(a,o);for(let i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(a,o),this.renderTargetsVertical[i].setSize(a,o),this.separableBlurMaterials[i].uniforms.invSize.value=new x(1/a,1/o),a=Math.round(a/2),o=Math.round(o/2)}render(e,t,a,o,i){e.getClearColor(this._oldClearColor),this._oldClearAlpha=e.getClearAlpha();const r=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),i&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this._fsQuad.material=this._basic,this._basic.map=a.texture,e.setRenderTarget(null),e.clear(),this._fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=a.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this._fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this._fsQuad.render(e);let n=this.renderTargetBright;for(let l=0;l<this.nMips;l++)this._fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=n.texture,this.separableBlurMaterials[l].uniforms.direction.value=F.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this._fsQuad.render(e),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=F.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this._fsQuad.render(e),n=this.renderTargetsVertical[l];this._fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this._fsQuad.render(e),this._fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(a),this._fsQuad.render(e)),e.setClearColor(this._oldClearColor,this._oldClearAlpha),e.autoClear=r}_getSeparableBlurMaterial(e){const t=[],a=e/3;for(let o=0;o<e;o++)t.push(.39894*Math.exp(-.5*o*o/(a*a))/a);return new B({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new x(.5,.5)},direction:{value:new x(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:`

				varying vec2 vUv;

				void main() {

					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

				}`,fragmentShader:`

				#include <common>

				varying vec2 vUv;

				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {

					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;

					for ( int i = 1; i < KERNEL_RADIUS; i ++ ) {

						float x = float( i );
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += ( sample1 + sample2 ) * w;

					}

					gl_FragColor = vec4( diffuseSum, 1.0 );

				}`})}_getCompositeMaterial(e){return new B({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`

				varying vec2 vUv;

				void main() {

					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

				}`,fragmentShader:`

				varying vec2 vUv;

				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor( const in float factor ) {

					float mirrorFactor = 1.2 - factor;
					return mix( factor, mirrorFactor, bloomRadius );

				}

				void main() {

					// 3.0 for backwards compatibility with previous alpha-based intensity
					vec3 bloom = 3.0 * bloomStrength * (
						lerpBloomFactor( bloomFactors[ 0 ] ) * bloomTintColors[ 0 ] * texture2D( blurTexture1, vUv ).rgb +
						lerpBloomFactor( bloomFactors[ 1 ] ) * bloomTintColors[ 1 ] * texture2D( blurTexture2, vUv ).rgb +
						lerpBloomFactor( bloomFactors[ 2 ] ) * bloomTintColors[ 2 ] * texture2D( blurTexture3, vUv ).rgb +
						lerpBloomFactor( bloomFactors[ 3 ] ) * bloomTintColors[ 3 ] * texture2D( blurTexture4, vUv ).rgb +
						lerpBloomFactor( bloomFactors[ 4 ] ) * bloomTintColors[ 4 ] * texture2D( blurTexture5, vUv ).rgb
					);

					float bloomAlpha = max( bloom.r, max( bloom.g, bloom.b ) );
					gl_FragColor = vec4( bloom, bloomAlpha );

				}`})}}F.BlurDirectionX=new x(1,0);F.BlurDirectionY=new x(0,1);const Ne={name:"RGBShiftShader",uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float amount;
		uniform float angle;

		varying vec2 vUv;

		void main() {

			vec2 offset = amount * vec2( cos(angle), sin(angle));
			vec4 cr = texture2D(tDiffuse, vUv + offset);
			vec4 cga = texture2D(tDiffuse, vUv);
			vec4 cb = texture2D(tDiffuse, vUv - offset);
			gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);

		}`};class He extends he{constructor(){super(),this.name="RoomEnvironment";const e=new Q;e.deleteAttribute("uv");const t=new V({side:xe}),a=new V,o=new X(16777215,900,28,2);o.position.set(.418,16.199,.3),this.add(o);const i=new p(e,t);i.position.set(-.757,13.219,.717),i.scale.set(31.713,28.305,28.591),this.add(i);const r=new ce(e,a,6),n=new W;n.position.set(-10.906,2.009,1.846),n.rotation.set(0,-.195,0),n.scale.set(2.328,7.905,4.651),n.updateMatrix(),r.setMatrixAt(0,n.matrix),n.position.set(-5.607,-.754,-.758),n.rotation.set(0,.994,0),n.scale.set(1.97,1.534,3.955),n.updateMatrix(),r.setMatrixAt(1,n.matrix),n.position.set(6.167,.857,7.803),n.rotation.set(0,.561,0),n.scale.set(3.927,6.285,3.687),n.updateMatrix(),r.setMatrixAt(2,n.matrix),n.position.set(-2.017,.018,6.124),n.rotation.set(0,.333,0),n.scale.set(2.002,4.566,2.064),n.updateMatrix(),r.setMatrixAt(3,n.matrix),n.position.set(2.291,-.756,-2.621),n.rotation.set(0,-.286,0),n.scale.set(1.546,1.552,1.496),n.updateMatrix(),r.setMatrixAt(4,n.matrix),n.position.set(-2.193,-.369,-5.547),n.rotation.set(0,.516,0),n.scale.set(3.875,3.487,2.986),n.updateMatrix(),r.setMatrixAt(5,n.matrix),this.add(r);const l=new p(e,P(50));l.position.set(-16.116,14.37,8.208),l.scale.set(.1,2.428,2.739),this.add(l);const c=new p(e,P(50));c.position.set(-16.109,18.021,-8.207),c.scale.set(.1,2.425,2.751),this.add(c);const h=new p(e,P(17));h.position.set(14.904,12.198,-1.832),h.scale.set(.15,4.265,6.331),this.add(h);const u=new p(e,P(43));u.position.set(-.462,8.89,14.52),u.scale.set(4.38,5.441,.088),this.add(u);const d=new p(e,P(20));d.position.set(3.235,11.486,-12.541),d.scale.set(2.5,2,.1),this.add(d);const f=new p(e,P(100));f.position.set(0,20,0),f.scale.set(1,.1,1),this.add(f)}dispose(){const e=new Set;this.traverse(t=>{t.isMesh&&(e.add(t.geometry),e.add(t.material))});for(const t of e)t.dispose()}}function P(s){return new we({color:0,emissive:16777215,emissiveIntensity:s})}const Oe={name:"VisualizerControls",components:{Icon:_e},props:{hasAudio:Boolean,isLoading:Boolean,uploadProgress:{type:Number,default:0},fileName:String,isPlaying:Boolean,currentTime:Number,duration:Number,volume:Number,currentMode:String,modes:Array,demoSongs:Array},emits:["upload","reset","seek","togglePlay","toggleMute","updateVolume","setMode","selectDemo"],computed:{volumeIcon(){return this.volume===0?"mdi:volume-mute":this.volume<.5?"mdi:volume-medium":"mdi:volume-high"}},methods:{formatTime(s){const e=Math.floor(s/60),t=Math.floor(s%60);return`${e}:${t.toString().padStart(2,"0")}`}}},Ye={class:"control-card glass-panel"},Qe={class:"card-header"},Xe={key:0,class:"upload-section"},We={key:0,class:"demo-songs"},Ze={class:"song-list"},qe=["onClick","disabled"],Ke=["disabled"],je={key:1,class:"progress-bar-container"},Je={key:1,class:"controls-section"},$e={class:"track-info"},et={class:"track-name"},tt={class:"progress-container"},st={class:"time"},it=["max","value"],ot={class:"time"},at={class:"playback-controls"},rt={class:"volume-control"},nt=["value"],lt={class:"mode-selector"},ht=["onClick"];function ct(s,e,t,a,o,i){const r=de("Icon");return g(),w("div",Ye,[m("div",Qe,[m("h2",null,[b(r,{icon:"mdi:waveform"}),e[7]||(e[7]=O(" Sonic Visualizer",-1))]),m("div",{class:ie(["status-indicator",{active:t.isPlaying}])},null,2)]),t.hasAudio?(g(),w("div",Je,[m("div",$e,[m("span",et,A(t.fileName),1),m("button",{class:"btn-icon small",onClick:e[2]||(e[2]=n=>s.$emit("reset")),title:"Change Track"},[b(r,{icon:"mdi:close"})])]),m("div",tt,[m("span",st,A(i.formatTime(t.currentTime)),1),m("input",{type:"range",min:"0",max:t.duration,step:"0.1",value:t.currentTime,onInput:e[3]||(e[3]=n=>s.$emit("seek",n.target.value)),class:"seek-slider"},null,40,it),m("span",ot,A(i.formatTime(t.duration)),1)]),m("div",at,[m("button",{class:"btn-icon",onClick:e[4]||(e[4]=n=>s.$emit("togglePlay"))},[b(r,{icon:t.isPlaying?"mdi:pause":"mdi:play",width:"32"},null,8,["icon"])]),m("div",rt,[b(r,{icon:i.volumeIcon,width:"20",onClick:e[5]||(e[5]=n=>s.$emit("toggleMute")),class:"mute-btn"},null,8,["icon"]),m("input",{type:"range",min:"0",max:"1",step:"0.01",value:t.volume,onInput:e[6]||(e[6]=n=>s.$emit("updateVolume",n.target.value)),class:"volume-slider"},null,40,nt)])]),m("div",lt,[(g(!0),w(oe,null,ae(t.modes,n=>(g(),w("button",{key:n.id,class:ie(["mode-btn",{active:t.currentMode===n.id}]),onClick:l=>s.$emit("setMode",n.id)},[b(r,{icon:n.icon},null,8,["icon"]),O(" "+A(n.label),1)],10,ht))),128))])])):(g(),w("div",Xe,[t.demoSongs&&t.demoSongs.length?(g(),w("div",We,[e[8]||(e[8]=m("p",{class:"section-label"},"Select a Demo Track",-1)),m("div",Ze,[(g(!0),w(oe,null,ae(t.demoSongs,n=>(g(),w("button",{key:n.path,class:"song-btn",onClick:l=>s.$emit("selectDemo",n),disabled:t.isLoading},[b(r,{icon:"mdi:music-note"}),m("span",null,A(n.title),1)],8,qe))),128))]),e[9]||(e[9]=m("div",{class:"divider"},[m("span",null,"OR")],-1))])):re("",!0),m("input",{type:"file",ref:"fileInput",accept:"audio/mp3,audio/wav,audio/ogg,audio/aac",class:"hidden-input",onChange:e[0]||(e[0]=n=>s.$emit("upload",n))},null,544),m("button",{class:"btn btn-primary upload-btn",onClick:e[1]||(e[1]=n=>s.$refs.fileInput.click()),disabled:t.isLoading},[t.isLoading?(g(),ne(r,{key:0,icon:"mdi:loading",class:"spin"})):(g(),ne(r,{key:1,icon:"mdi:upload"})),O(" "+A(t.isLoading?t.uploadProgress===100?"Processing...":`Uploading ${t.uploadProgress}%`:"Upload Custom Audio File"),1)],8,Ke),t.isLoading&&t.uploadProgress<100?(g(),w("div",je,[m("div",{class:"progress-bar",style:ze({width:t.uploadProgress+"%"})},null,4)])):re("",!0),e[10]||(e[10]=m("p",{class:"hint"},"Supports MP3, WAV, AAC, OGG",-1))]))])}const ut=ue(Oe,[["render",ct],["__scopeId","data-v-ca44226d"]]),dt={data(){return{audioContext:null,audioBuffer:null,sourceNode:null,analyser:null,gainNode:null,isPlaying:!1,startTime:0,pausedAt:0,currentTime:0,duration:0,volume:.7,isLoading:!1,uploadProgress:0,currentFileName:"",dataArray:null}},methods:{async initAudioContext(){this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2048,this.dataArray=new Uint8Array(this.analyser.frequencyBinCount),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=this.volume,this.gainNode.connect(this.audioContext.destination))},async loadAudioFile(s){if(s){this.isLoading=!0,this.currentFileName=s.name,this.uploadProgress=0;try{await this.initAudioContext();const e=new FileReader,t=await new Promise((o,i)=>{e.onprogress=r=>{r.lengthComputable&&(this.uploadProgress=Math.round(r.loaded/r.total*100))},e.onload=r=>o(r.target.result),e.onerror=r=>i(r),e.readAsArrayBuffer(s)});this.uploadProgress=100;const a=await this.audioContext.decodeAudioData(t);this.audioBuffer=a,this.duration=a.duration,this.playAudio()}catch(e){console.error("Error loading audio:",e),alert("Failed to load audio file.")}finally{this.isLoading=!1,this.uploadProgress=0}}},playAudio(){this.sourceNode&&(this.sourceNode.stop(),this.sourceNode.disconnect()),this.sourceNode=this.audioContext.createBufferSource(),this.sourceNode.buffer=this.audioBuffer,this.sourceNode.connect(this.analyser),this.analyser.connect(this.gainNode);const s=this.pausedAt;this.sourceNode.start(0,s),this.startTime=this.audioContext.currentTime-s,this.isPlaying=!0,this.sourceNode.onended=()=>{this.currentTime>=this.duration&&(this.isPlaying=!1,this.pausedAt=0,this.currentTime=0)}},pauseAudio(){this.sourceNode&&(this.sourceNode.stop(),this.pausedAt=this.audioContext.currentTime-this.startTime,this.isPlaying=!1)},togglePlay(){this.isPlaying?this.pauseAudio():this.playAudio()},seekAudio(){this.isPlaying&&this.sourceNode.stop(),this.pausedAt=this.currentTime,this.isPlaying&&this.playAudio()},updateVolume(){this.gainNode&&(this.gainNode.gain.value=this.volume)},resetAudio(){this.pauseAudio(),this.audioBuffer=null,this.currentFileName="",this.currentTime=0,this.duration=0,this.pausedAt=0},updateAudioTime(){this.isPlaying&&this.audioContext&&(this.currentTime=this.audioContext.currentTime-this.startTime)},getAudioData(){return this.analyser&&this.isPlaying?(this.analyser.getByteFrequencyData(this.dataArray),this.dataArray):null}},beforeUnmount(){this.audioContext&&this.audioContext.close()}},mt=`
  vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
  vec4 mod289(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
  vec4 permute(vec4 x) { return mod289(((x*34.0)+1.0)*x); }
  vec4 taylorInvSqrt(vec4 r) { return 1.79284291400159 - 0.85373472095314 * r; }
  float snoise(vec3 v) {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 = v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy;
    vec3 x3 = x0 - D.yyy;
    i = mod289(i);
    vec4 p = permute( permute( permute( 
              i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
            + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
            + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    float n_ = 0.142857142857;
    vec3  ns = n_ * D.wyz - D.xzx;
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    return 10.0 * ( dot(p0, x0) + dot(p1, x1) + dot(p2, x2) + dot(p3, x3) ); // Scaled for intensity
  }
`,ft={name:"AudioVisualizerView",components:{VisualizerControls:ut},mixins:[dt],data(){return{currentMode:"blob",modes:[{id:"blob",label:"Chrome Blob",icon:"mdi:water"},{id:"sphere",label:"Glass Sphere",icon:"mdi:crystal-ball"},{id:"terrain",label:"Cyber Terrain",icon:"mdi:terrain"},{id:"neural",label:"Neural Net",icon:"mdi:brain"},{id:"vortex",label:"Black Hole",icon:"mdi:black-hole"},{id:"shards",label:"Crystal Shards",icon:"mdi:shimmer"},{id:"radial",label:"Minimal Radial",icon:"mdi:circle-outline"},{id:"orb",label:"Classic Orb",icon:"mdi:earth"},{id:"galaxy",label:"Galaxy",icon:"mdi:creation"}],demoSongs:[{title:"Eiffel 65 - Blue (Hardstyle Remix)",path:"/songs/Eiffel 65 - Blue (Hardstyle Remix By Team Blue) [MONKEY TEMPO].mp3"},{title:"Everytime We Touch (Hardstyle)",path:"/songs/Everytime We Touch (Hardstyle).mp3"},{title:"Gonzi - BASSKILLER",path:"/songs/Gonzi - BASSKILLER.mp3"}],prevVolume:.7,isControlsVisible:!0,controlsTimeout:null}},created(){this.scene=null,this.camera=null,this.renderer=null,this.meshGroup=null,this.animationId=null},mounted(){this.initThree(),window.addEventListener("resize",this.handleResize),this.animationLoop()},beforeUnmount(){this.cleanupThree(),window.removeEventListener("resize",this.handleResize),this.controlsTimeout&&clearTimeout(this.controlsTimeout)},watch:{audioBuffer(s){s?(this.setControlsVisibility(!1),this.currentMode="orb",this.updateVisualizerMode()):this.setControlsVisibility(!0)}},methods:{showControlsTemporary(){this.audioBuffer&&(this.setControlsVisibility(!0),this.controlsTimeout&&clearTimeout(this.controlsTimeout),this.controlsTimeout=setTimeout(()=>{this.isPlaying&&this.setControlsVisibility(!1)},3e3))},setControlsVisibility(s){this.isControlsVisible=s,window.dispatchEvent(new CustomEvent("visualizer-ui-toggle",{detail:s}))},async handleDemoSelect(s){this.isLoading=!0,this.currentFileName=s.title,this.uploadProgress=0;try{await this.initAudioContext();const t=await(await fetch(s.path)).arrayBuffer();this.uploadProgress=100;const a=await this.audioContext.decodeAudioData(t);this.audioBuffer=a,this.duration=a.duration,this.playAudio()}catch(e){console.error("Error loading demo:",e)}finally{this.isLoading=!1}},handleFileUpload(s){this.loadAudioFile(s.target.files[0])},handleSeek(s){this.currentTime=parseFloat(s),this.seekAudio()},handleVolumeChange(s){this.volume=parseFloat(s),this.updateVolume()},toggleMute(){this.volume>0?(this.prevVolume=this.volume,this.volume=0):this.volume=this.prevVolume||.7,this.updateVolume()},initThree(){const s=this.$refs.canvasContainer;this.renderer=q.mount(s),this.scene=new he,this.scene.fog=new ee(723724,.03),this.camera=new Se(75,window.innerWidth/window.innerHeight,.1,1e3);const e=window.innerWidth<768;this.camera.position.set(0,0,e?35:20),this.camera.lookAt(0,0,0);const t=new Ae(this.renderer);t.compileEquirectangularShader(),this.scene.environment=t.fromScene(new He).texture,this.scene.add(new Pe(16777215,.5));const a=new X(1030834,2);a.position.set(20,20,20),this.scene.add(a);const o=new X(16777215,1.5);o.position.set(-20,-20,-20),this.scene.add(o),this.createVisualizerGroup(),this.createShockwave(),this.initPostProcessing()},initPostProcessing(){const s=new Le(this.scene,this.camera),e=new F(new x(window.innerWidth,window.innerHeight),1.5,.4,.85);e.threshold=.2,e.strength=1,e.radius=.5;const t=new fe(Ne);t.uniforms.amount.value=.0015,this.composer=new Ve(this.renderer),this.composer.addPass(s),this.composer.addPass(e),this.composer.addPass(t)},createVisualizerGroup(){this.meshGroup&&this.scene.remove(this.meshGroup),this.meshGroup=new Te,this.scene.add(this.meshGroup),this.updateVisualizerMode()},createShockwave(){const s=new J(10,11,64),e=new z({color:1030834,side:H,transparent:!0,opacity:0});this.shockwave=new p(s,e),this.shockwave.rotation.x=-Math.PI/2,this.shockwave.visible=!1,this.scene.add(this.shockwave)},setMode(s){this.currentMode=s,this.updateVisualizerMode()},updateVisualizerMode(){if(!this.meshGroup)return;for(;this.meshGroup.children.length>0;){const e=this.meshGroup.children[0];e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach(t=>t.dispose()):e.material.dispose()),this.meshGroup.remove(e)}const s=window.innerWidth<768;switch(this.camera.position.set(0,0,s?35:20),this.camera.rotation.set(0,0,0),this.scene.background=null,this.scene.environment=null,this.currentMode){case"blob":this.createBlob();break;case"sphere":this.createSphere();break;case"terrain":this.createTerrain();break;case"neural":this.createNeural();break;case"vortex":this.createVortex();break;case"shards":this.createShards();break;case"radial":this.createRadial();break;case"orb":this.createOrb();break;case"galaxy":this.createGalaxy();break;default:this.createOrb()}},createOrb(){const s=new te(4,4),e=new se({color:723724,emissive:1030834,emissiveIntensity:.5,wireframe:!0,transparent:!0,opacity:.9}),t=new p(s,e);this.meshGroup.add(t)},createGalaxy(){const s=new y,e=5e3,t=new Float32Array(e*3),a=new Float32Array(e*3),o=new Float32Array(e);for(let r=0;r<e;r++){const n=Math.random()*Math.PI*2,l=Math.random()*20,c=n+l*.5;t[r*3]=Math.cos(c)*l,t[r*3+1]=(Math.random()-.5)*2,t[r*3+2]=Math.sin(c)*l;const h=Math.random();a[r*3]=h*0,a[r*3+1]=.8+h*.2,a[r*3+2]=.8+h*.2,o[r]=Math.random()}s.setAttribute("position",new v(t,3)),s.setAttribute("color",new v(a,3)),s.setAttribute("size",new v(o,1));const i=new T({size:.1,vertexColors:!0,transparent:!0,opacity:.8,blending:_,sizeAttenuation:!0});this.meshGroup.add(new S(s,i))},createBars(){const t=new Q(.5,.5,.5),a=new se({color:1030834,emissive:12339,specular:16777215,shininess:100});for(let o=0;o<64;o++){const i=new p(t,a),r=o/64*Math.PI*2;i.position.x=Math.cos(r)*10,i.position.z=Math.sin(r)*10,i.rotation.y=-r,i.userData={index:o,angle:r},this.meshGroup.add(i)}},createGrid(){const t=new Q(.5,.5,.5),a=new z({color:16777215,wireframe:!0});for(let o=0;o<10;o++)for(let i=0;i<10;i++){const r=new p(t,a);r.position.set((o-10/2)*2,0,(i-10/2)*2),r.userData={x:o,z:i},this.meshGroup.add(r)}this.meshGroup.rotation.x=.5,this.meshGroup.rotation.y=.5},createWave(){const s=new $(60,20,63,20),e=new z({color:57568,wireframe:!0,side:H}),t=new p(s,e);t.rotation.x=-Math.PI/3,this.meshGroup.add(t)},createParticles(){const s=new y,e=2e3,t=new Float32Array(e*3);for(let o=0;o<e;o++)t[o*3]=(Math.random()-.5)*50,t[o*3+1]=(Math.random()-.5)*50,t[o*3+2]=(Math.random()-.5)*50;s.setAttribute("position",new v(t,3));const a=new T({size:.2,color:16777215,transparent:!0,opacity:.8});this.meshGroup.add(new S(s,a))},animationLoop(){this.animationId=requestAnimationFrame(this.animationLoop),this.updateAudioTime();const s=this.getAudioData();if(this.meshGroup)if(s&&this.isPlaying){const e=s.reduce((a,o)=>a+o,0)/s.length,t=s.slice(0,10).reduce((a,o)=>a+o,0)/10;switch(t>200&&!this.isShockwaving&&this.triggerShockwave(),this.updateShockwave(),this.currentMode){case"blob":this.animateBlob(s,e,t);break;case"sphere":this.animateSphere(s,e,t);break;case"terrain":this.animateTerrain(s,e,t);break;case"neural":this.animateNeural(s,e,t);break;case"vortex":this.animateVortex(s,e,t);break;case"shards":this.animateShards(s,e,t);break;case"radial":this.animateRadial(s,e,t);break;case"orb":this.animateOrb(s,e,t);break;case"galaxy":this.animateGalaxy(s,e,t);break;default:this.animateOrb(s,e,t)}if(["blob","sphere","orb","radial"].includes(this.currentMode)){const a=window.innerWidth<768?35:20;this.camera.position.z=a-t/50}}else this.meshGroup.rotation.y+=.002;this.composer?this.composer.render():this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera)},triggerShockwave(){this.isShockwaving=!0,this.shockwave.visible=!0,this.shockwave.scale.set(1,1,1),this.shockwave.material.opacity=.8,setTimeout(()=>{this.isShockwaving=!1},300)},updateShockwave(){this.shockwave.visible&&(this.shockwave.scale.x+=.5,this.shockwave.scale.y+=.5,this.shockwave.material.opacity-=.04,this.shockwave.material.opacity<=0&&(this.shockwave.visible=!1))},createBlob(){const s=new te(8,40),e=new V({color:723724,roughness:.1,metalness:.9,emissive:57568,emissiveIntensity:.2});e.onBeforeCompile=a=>{a.uniforms.uTime={value:0},a.uniforms.uBass={value:0},a.vertexShader=`
          uniform float uTime;
          uniform float uBass;
          ${mt}
        `+a.vertexShader,a.vertexShader=a.vertexShader.replace("#include <begin_vertex>",`
          #include <begin_vertex>
          float noise = snoise(vec3(position * 0.5 + uTime * 0.5));
          float displacement = noise * (2.0 + uBass * 0.05);
          vec3 newPos = position + normal * displacement;
          transformed = newPos;
          `),e.userData.shader=a};const t=new p(s,e);this.meshGroup.add(t)},animateBlob(s,e,t){const a=this.meshGroup.children[0];a.material.userData.shader&&(a.material.userData.shader.uniforms.uTime.value=performance.now()/1e3,a.material.userData.shader.uniforms.uBass.value=t),a.rotation.y+=.002},createSphere(){const s=new Ce(7,64,64),e=new j({color:16777215,metalness:0,roughness:0,transmission:1,thickness:2,ior:1.5,clearcoat:1,clearcoatRoughness:0,transparent:!0,opacity:1}),t=new p(s,e);this.meshGroup.add(t);const a=new y,o=200,i=new Float32Array(o*3);for(let l=0;l<o;l++){const c=4*Math.random(),h=Math.random()*Math.PI*2,u=Math.acos(2*Math.random()-1);i[l*3]=c*Math.sin(u)*Math.cos(h),i[l*3+1]=c*Math.sin(u)*Math.sin(h),i[l*3+2]=c*Math.cos(u)}a.setAttribute("position",new v(i,3));const r=new T({color:57568,size:.2,blending:_}),n=new S(a,r);this.meshGroup.add(n)},animateSphere(s,e,t){const a=this.meshGroup.children[0],o=this.meshGroup.children[1];a.rotation.y+=.002,o.rotation.y-=.005;const i=s[s.length/2]/255;o.material.color.setHSL(.5,1,.5+i*.4);const r=o.geometry.attributes.position;for(let n=0;n<r.count;n++)t>100&&r.setY(n,r.getY(n)+(Math.random()-.5)*.1);r.needsUpdate=!0},createTerrain(){const s=new $(200,200,64,64),e=new V({color:723724,emissive:57568,emissiveIntensity:.5,wireframe:!0,displacementScale:20}),t=new p(s,e);t.rotation.x=-Math.PI/2,t.position.y=-10,this.meshGroup.add(t),this.scene.fog=new ee(723724,.02)},animateTerrain(s,e,t){const o=this.meshGroup.children[0].geometry.attributes.position,i=.8+t/50;for(let r=0;r<o.count;r++){let n=o.getZ(r);n+=i,n>100&&(n-=200),o.setZ(r,n);const l=o.getX(r),c=Math.floor(Math.abs(l)%s.length),h=s[c]/255,u=Math.sin(l*.1+performance.now()*.001)*2,d=h*15;o.setZ(r,u+d)}o.needsUpdate=!0,this.camera.position.x=Math.sin(performance.now()*5e-4)*5,this.camera.position.y=15+Math.cos(performance.now()*5e-4)*2,this.camera.lookAt(0,0,-20)},createNeural(){const e=new y,t=new Float32Array(200*3);for(let h=0;h<200;h++)t[h*3]=(Math.random()-.5)*40,t[h*3+1]=(Math.random()-.5)*40,t[h*3+2]=(Math.random()-.5)*40;e.setAttribute("position",new v(t,3));const a=new T({color:57568,size:.5,transparent:!0,opacity:.8}),o=new S(e,a);this.meshGroup.add(o);const i=new y,r=200*2,n=new Float32Array(r*6);i.setAttribute("position",new v(n,3));const l=new N({color:57568,transparent:!0,opacity:.2,blending:_}),c=new Me(i,l);this.meshGroup.add(c)},animateNeural(s,e,t){const a=this.meshGroup.children[0],o=this.meshGroup.children[1],i=a.geometry.attributes.position,r=1+t/100;a.scale.set(r,r,r),a.rotation.y+=.001,o.rotation.y+=.001;const n=o.geometry.attributes.position;let l=0;const c=10+e/10;for(let h=0;h<i.count;h++)i.setX(h,i.getX(h)+Math.sin(performance.now()*.001+h)*.05);i.needsUpdate=!0;for(let h=0;h<i.count-1&&!(l>=n.count);h++){const u=i.getX(h),d=i.getY(h),f=i.getZ(h),M=i.getX(h+1),D=i.getY(h+1),L=i.getZ(h+1);Math.sqrt((M-u)**2+(D-d)**2+(L-f)**2)<c?(n.setXYZ(l++,u,d,f),n.setXYZ(l++,M,D,L)):(n.setXYZ(l++,0,0,0),n.setXYZ(l++,0,0,0))}o.geometry.attributes.position.needsUpdate=!0},createVortex(){const e=new y,t=new Float32Array(2e3*3),a=new Float32Array(2e3*3);for(let d=0;d<2e3;d++){const f=Math.random()*30+5,M=Math.random()*Math.PI*2;t[d*3]=f*Math.cos(M),t[d*3+1]=(Math.random()-.5)*5,t[d*3+2]=f*Math.sin(M),a[d*3]=0,a[d*3+1]=.8+Math.random()*.2,a[d*3+2]=.8+Math.random()*.2}e.setAttribute("position",new v(t,3)),e.setAttribute("color",new v(a,3));const o=new T({size:.2,vertexColors:!0,blending:_,transparent:!0,opacity:.8}),i=new S(e,o);this.meshGroup.add(i);const r=new be(4,32),n=new z({color:723724}),l=new p(r,n);l.rotation.x=-Math.PI/2,this.meshGroup.add(l);const c=new J(4,4.5,32),h=new z({color:57568,side:H,transparent:!0,opacity:.5}),u=new p(c,h);u.rotation.x=-Math.PI/2,this.meshGroup.add(u)},animateVortex(s,e,t){const a=this.meshGroup.children[0],o=a.geometry.attributes.position,i=a.geometry.attributes.color,r=.005+t/5e3;a.rotation.y+=r;const n=s.slice(Math.floor(s.length*.7)).reduce((h,u)=>h+u,0)/(s.length*.3);for(let h=0;h<o.count;h++){const u=o.getX(h),d=o.getZ(h),f=Math.sqrt(u*u+d*d);if(f<4){const I=Math.random()*Math.PI*2;o.setX(h,35*Math.cos(I)),o.setZ(h,35*Math.sin(I)),i.setXYZ(h,0,.5+Math.random()*.5,1)}else o.setX(h,u*.99),o.setZ(h,d*.99),n>50&&Math.random()<.02?i.setXYZ(h,1,1,1):i.getX(h)>.1&&i.setX(h,i.getX(h)*.9);const M=Math.floor(f/35*s.length),D=s[M]/255;o.setY(h,D*8*(Math.random()>.5?1:-1))}o.needsUpdate=!0,i.needsUpdate=!0;const l=this.meshGroup.children[2],c=1+t/200;l.scale.set(c,c,c)},createShards(){const e=new ye(1,0),t=new j({color:57568,metalness:1,roughness:.2,transmission:.5,thickness:1,transparent:!0,opacity:.8}),a=new ce(e,t,200),o=new W;for(let i=0;i<200;i++){o.position.set((Math.random()-.5)*40,(Math.random()-.5)*40,(Math.random()-.5)*40),o.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI);const r=Math.random()*2;o.scale.set(r,r,r),o.updateMatrix(),a.setMatrixAt(i,o.matrix)}this.meshGroup.add(a)},animateShards(s,e,t){const a=this.meshGroup.children[0];new W,a.count,a.rotation.y+=.001,a.rotation.z+=.001,t>150&&(a.rotation.y+=.05);const o=s[30]/255;a.material.emissive.setHSL(.5,1,o*.5)},createRadial(){const t=[];for(let l=0;l<=128;l++){const c=l/128*Math.PI*2;t.push(new C(Math.cos(c)*10,Math.sin(c)*10,0))}const a=new y().setFromPoints(t),o=new N({color:57568,linewidth:2}),i=new K(a,o);this.meshGroup.add(i);const r=new N({color:16777215,linewidth:1,transparent:!0,opacity:.5}),n=new K(a.clone(),r);n.scale.set(.5,.5,.5),this.meshGroup.add(n)},animateRadial(s,e,t){const o=this.meshGroup.children[0].geometry.attributes.position,i=o.count,r=10+t/20;for(let c=0;c<i;c++){const h=c/(i-1)*Math.PI*2,u=Math.floor(c/i*s.length*.5),d=s[u]/255,f=r+d*10;o.setXYZ(c,Math.cos(h)*f,Math.sin(h)*f,0)}o.needsUpdate=!0;const n=this.meshGroup.children[1];n.rotation.z-=.01;const l=.5+e/100;n.scale.set(l,l,l)},animateOrb(s,e,t){const a=this.meshGroup.children[0],o=a.geometry.attributes.position,i=new C;for(let r=0;r<o.count;r++){i.fromBufferAttribute(o,r),i.normalize();const n=r%s.length,c=4+s[n]/255*3+t/60;i.multiplyScalar(c),o.setXYZ(r,i.x,i.y,i.z)}a.geometry.attributes.position.needsUpdate=!0,a.rotation.z+=.002,a.rotation.y+=.002},animateGalaxy(s,e,t){const a=this.meshGroup.children[0],o=a.geometry.attributes.position,i=o.count,r=1+t/500;a.scale.set(r,r,r),a.rotation.y+=.001+e*1e-4;for(let n=0;n<i;n++){let l=o.getY(n);l+=Math.sin(Date.now()*.001+o.getX(n))*.02,o.setY(n,l)}o.needsUpdate=!0},animateBars(s,e,t){this.meshGroup.children.forEach((a,o)=>{const i=Math.floor(o/this.meshGroup.children.length*(s.length/4)),r=s[i]||0,n=1+r/10;a.scale.set(1,n,1),a.material.color.setHSL(.5,1,.3+r/510)}),this.meshGroup.rotation.y+=.005,this.meshGroup.rotation.z=Math.sin(Date.now()*.001)*.2},animateGrid(s,e,t){this.meshGroup.children.forEach((a,o)=>{const i=s[o%(s.length/2)]/255;a.position.y=i*10,a.scale.set(1,1+i*5,1),a.material.color.setHSL(.5,1,.3+i*.7)}),this.meshGroup.rotation.y+=.002},animateWave(s,e,t){const o=this.meshGroup.children[0].geometry.attributes.position,i=64;for(let r=0;r<o.count;r++){const n=r%i,l=s[n*2]/255;o.getY(r);const c=l*10+Math.sin(r*.1+Date.now()*.005)*2;o.setZ(r,c)}o.needsUpdate=!0},animateParticles(s,e,t){const a=this.meshGroup.children[0];a.rotation.y+=.001+e*1e-4;const o=a.geometry.attributes.position,i=t/255;for(let n=0;n<o.count;n++)i>.5&&o.setY(n,o.getY(n)+(Math.random()-.5)*i);o.needsUpdate=!0;const r=1+t/100;a.scale.set(r,r,r)},createHelix(){const s=new y,e=1e3,t=new Float32Array(e*3),a=new Float32Array(e*3),o=new k(57568),i=new k(16777215);for(let l=0;l<e;l++){const c=l*3,h=l*.1,u=5,d=l%2===0?1:-1;t[c]=Math.cos(h)*u*d,t[c+1]=l*.05-25,t[c+2]=Math.sin(h)*u*d;const f=l%2===0?o:i;a[c]=f.r,a[c+1]=f.g,a[c+2]=f.b}s.setAttribute("position",new v(t,3)),s.setAttribute("color",new v(a,3));const r=new T({size:.3,vertexColors:!0,transparent:!0,opacity:.8,blending:_}),n=new S(s,r);n.rotation.z=Math.PI/6,this.meshGroup.add(n)},animateHelix(s,e,t){const a=this.meshGroup.children[0];a.rotation.y+=.02;const o=a.geometry.attributes.position;for(let i=0;i<o.count;i++){const r=o.getY(i),n=Math.floor((r+25)/50*s.length),l=Math.max(0,Math.min(n,s.length-1)),c=s[l]/255,h=i*.1,u=5+c*5,d=i%2===0?1:-1;o.setX(i,Math.cos(h)*u*d),o.setZ(i,Math.sin(h)*u*d)}o.needsUpdate=!0},handleResize(){if(this.camera){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix();const s=window.innerWidth<768;this.camera.position.z=s?35:20}this.composer&&this.composer.setSize(window.innerWidth,window.innerHeight)},cleanupThree(){cancelAnimationFrame(this.animationId),q.unmount(),this.scene&&this.scene.traverse(s=>{(s.isMesh||s.isPoints)&&(s.geometry.dispose(),Array.isArray(s.material)?s.material.forEach(e=>e.dispose()):s.material.dispose())})}}},pt={ref:"canvasContainer",class:"canvas-wrapper"},gt={class:"ui-overlay"};function vt(s,e,t,a,o,i){const r=de("VisualizerControls");return g(),w("div",{class:"visualizer-container",onMousemove:e[0]||(e[0]=(...n)=>i.showControlsTemporary&&i.showControlsTemporary(...n)),onClick:e[1]||(e[1]=(...n)=>i.showControlsTemporary&&i.showControlsTemporary(...n))},[m("div",pt,null,512),b(ke,{name:"fade"},{default:Be(()=>[Fe(m("div",gt,[b(r,{hasAudio:!!s.audioBuffer,isLoading:s.isLoading,uploadProgress:s.uploadProgress,fileName:s.currentFileName,isPlaying:s.isPlaying,currentTime:s.currentTime,duration:s.duration,volume:s.volume,currentMode:o.currentMode,modes:o.modes,demoSongs:o.demoSongs,onUpload:i.handleFileUpload,onSelectDemo:i.handleDemoSelect,onReset:s.resetAudio,onSeek:i.handleSeek,onTogglePlay:s.togglePlay,onToggleMute:i.toggleMute,onUpdateVolume:i.handleVolumeChange,onSetMode:i.setMode},null,8,["hasAudio","isLoading","uploadProgress","fileName","isPlaying","currentTime","duration","volume","currentMode","modes","demoSongs","onUpload","onSelectDemo","onReset","onSeek","onTogglePlay","onToggleMute","onUpdateVolume","onSetMode"])],512),[[Ge,o.isControlsVisible||!s.audioBuffer]])]),_:1})],32)}const yt=ue(ft,[["render",vt],["__scopeId","data-v-34c028ff"]]);export{yt as default};
